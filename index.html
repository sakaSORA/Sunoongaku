<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Suno AI ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#667eea">
    <link rel="apple-touch-icon" href="icon-192.png">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            height: 100vh;
            padding: 0;
            font-size: 14px;
            overflow: hidden;
        }

        .container {
            width: 100%;
            height: 100vh;
            margin: 0;
            background: white;
            display: flex;
            flex-direction: column;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 8px 20px;
            text-align: center;
            flex-shrink: 0;
        }

        .header h1 {
            font-size: 1em;
            margin: 0;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
        }

        .header p {
            display: none;
        }

        .main-content {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        .left-panel {
            width: 30%;
            overflow-y: auto;
            padding: 12px;
            background: #f8f9fa;
            border-right: 2px solid #dee2e6;
        }

        .right-panel {
            width: 70%;
            display: flex;
            flex-direction: column;
            background: white;
        }

        .lyrics-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 15px;
            overflow: hidden;
        }

        .output-section-bottom {
            flex-shrink: 0;
            background: #f8f9fa;
            padding: 12px 15px;
            border-top: 2px solid #dee2e6;
            max-height: 180px;
            display: flex;
            flex-direction: column;
        }

        .section {
            background: white;
            padding: 10px;
            border-radius: 6px;
            border: 1px solid #e9ecef;
            margin-bottom: 10px;
        }

        .section-title {
            font-size: 0.9em;
            color: #667eea;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .form-group {
            margin-bottom: 8px;
        }

        label {
            display: block;
            font-weight: 600;
            margin-bottom: 4px;
            color: #495057;
            font-size: 0.8em;
        }

        input[type="text"],
        input[type="number"],
        select {
            width: 100%;
            padding: 6px;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            font-size: 0.8em;
            font-family: inherit;
            transition: border-color 0.3s;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #667eea;
        }

        textarea {
            width: 100%;
            resize: none;
            flex: 1;
            font-size: 0.95em;
            line-height: 1.6;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            font-family: 'Courier New', monospace;
        }

        textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .lyrics-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .lyrics-title {
            font-size: 1em;
            color: #667eea;
            font-weight: 600;
        }

        .char-count {
            font-size: 0.75em;
            color: #6c757d;
        }

        .helper-text {
            font-size: 0.8em;
            color: #6c757d;
            margin-top: 4px;
        }

        .templates-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 8px;
        }

        .template-card {
            background: white;
            padding: 8px;
            border-radius: 6px;
            cursor: pointer;
            border: 1px solid #dee2e6;
            transition: all 0.3s;
            text-align: center;
        }

        .template-card:hover {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
        }

        .template-card.active {
            border-color: #667eea;
            background: #f0f3ff;
        }

        .template-emoji {
            font-size: 1.5em;
            margin-bottom: 4px;
        }

        .template-card .template-title {
            font-weight: 600;
            color: #667eea;
            margin-bottom: 2px;
            font-size: 0.8em;
        }

        .template-card .template-style {
            font-size: 0.7em;
            color: #6c757d;
        }

        .tags-display {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            margin-top: 4px;
        }

        .tag {
            background: #667eea;
            color: white;
            padding: 2px 6px;
            border-radius: 10px;
            font-size: 0.65em;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .tag-remove {
            cursor: pointer;
            font-weight: bold;
            opacity: 0.8;
        }

        .tag-remove:hover {
            opacity: 1;
        }

        .vocal-controls,
        .structure-tags {
            background: white;
            padding: 8px;
            border-radius: 4px;
            margin-top: 8px;
        }

        .control-title {
            font-weight: 600;
            margin-bottom: 5px;
            color: #495057;
            font-size: 0.8em;
        }

        .control-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
        }

        .control-tag {
            background: #e9ecef;
            padding: 4px 8px;
            border-radius: 10px;
            font-size: 0.7em;
            cursor: pointer;
            transition: all 0.3s;
        }

        .control-tag:hover {
            background: #667eea;
            color: white;
        }

        .output-box {
            background: #2d3748;
            color: #e2e8f0;
            padding: 10px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            overflow-y: auto;
            line-height: 1.4;
            font-size: 0.75em;
            flex: 1;
            margin-bottom: 8px;
        }

        .output-actions {
            display: flex;
            gap: 6px;
            justify-content: flex-end;
        }

        .btn {
            padding: 6px 12px;
            border: none;
            border-radius: 4px;
            font-size: 0.75em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 3px 10px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .btn-small {
            padding: 5px 10px;
            font-size: 0.7em;
        }

        .example-section {
            background: #fff3cd;
            padding: 8px;
            border-radius: 4px;
            margin-top: 8px;
            border-left: 3px solid #ffc107;
        }

        .example-title {
            font-weight: 600;
            color: #856404;
            margin-bottom: 5px;
            font-size: 0.8em;
        }

        .example-text {
            font-size: 0.75em;
            color: #856404;
            line-height: 1.5;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸµ Suno AI ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼</h1>
            <p>ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªæ¥½æ›²ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ç°¡å˜ä½œæˆ</p>
        </div>

        <div class="main-content">
            <div class="left-panel">
                <div class="section">
                    <h2 class="section-title">ğŸ“‹ ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆé¸æŠ</h2>
                    <div class="helper-text" style="margin-bottom: 12px;">
                        å¥½ããªã‚¸ãƒ£ãƒ³ãƒ«ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’é¸ã‚“ã§ã‹ã‚‰ã€æ­Œè©ã‚„ã‚¹ã‚¿ã‚¤ãƒ«ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º
                    </div>
                    <div class="templates-grid">
                        <div class="template-card" onclick="loadTemplate('rock')" data-template="rock">
                            <div class="template-emoji">ğŸ¸</div>
                            <div class="template-title">ã‚®ã‚¿ãƒ¼ãƒ­ãƒƒã‚¯</div>
                            <div class="template-style">ã‚ã„ã¿ã‚‡ã‚“é¢¨</div>
                        </div>
                        <div class="template-card" onclick="loadTemplate('enka')" data-template="enka">
                            <div class="template-emoji">ğŸ¤</div>
                            <div class="template-title">æ¼”æ­Œ</div>
                            <div class="template-style">ç¾ç©ºã²ã°ã‚Šé¢¨</div>
                        </div>
                        <div class="template-card" onclick="loadTemplate('symphonic')" data-template="symphonic">
                            <div class="template-emoji">âš”ï¸</div>
                            <div class="template-title">ãƒ¡ã‚¿ãƒ«</div>
                            <div class="template-style">ã‚·ãƒ³ãƒ•ã‚©ã‚®ã‚¢é¢¨</div>
                        </div>
                        <div class="template-card" onclick="loadTemplate('hyperpop')" data-template="hyperpop">
                            <div class="template-emoji">âœ¨</div>
                            <div class="template-title">ãƒã‚¤ãƒ‘ãƒ¼ãƒãƒƒãƒ—</div>
                            <div class="template-style">ä¸­æ¯’æ€§</div>
                        </div>
                        <div class="template-card" onclick="loadTemplate('funk')" data-template="funk">
                            <div class="template-emoji">ğŸ¹</div>
                            <div class="template-title">ãƒ•ã‚¡ãƒ³ã‚¯</div>
                            <div class="template-style">å’Œãƒ¢ãƒ€ãƒ³</div>
                        </div>
                        <div class="template-card" onclick="loadTemplate('vocaloid')" data-template="vocaloid">
                            <div class="template-emoji">ğŸµ</div>
                            <div class="template-title">ãƒœã‚«ãƒ­</div>
                            <div class="template-style">åˆéŸ³ãƒŸã‚¯é¢¨</div>
                        </div>
                        <div class="template-card" onclick="loadTemplate('anime')" data-template="anime">
                            <div class="template-emoji">ğŸŒŸ</div>
                            <div class="template-title">ã‚¢ãƒ‹ã‚½ãƒ³</div>
                            <div class="template-style">ç†±è¡€OP</div>
                        </div>
                        <div class="template-card" onclick="loadTemplate('ballad')" data-template="ballad">
                            <div class="template-emoji">ğŸ’”</div>
                            <div class="template-title">ãƒãƒ©ãƒ¼ãƒ‰</div>
                            <div class="template-style">å®‡å¤šç”°é¢¨</div>
                        </div>
                        <div class="template-card" onclick="loadTemplate('citypop')" data-template="citypop">
                            <div class="template-emoji">ğŸŒƒ</div>
                            <div class="template-title">ã‚·ãƒ†ã‚£ãƒãƒƒãƒ—</div>
                            <div class="template-style">80å¹´ä»£</div>
                        </div>
                        <div class="template-card" onclick="loadTemplate('edm')" data-template="edm">
                            <div class="template-emoji">ğŸ”Š</div>
                            <div class="template-title">EDM</div>
                            <div class="template-style">ã‚¯ãƒ©ãƒ–</div>
                        </div>
                        <div class="template-card" onclick="loadTemplate('hiphop')" data-template="hiphop">
                            <div class="template-emoji">ğŸ§</div>
                            <div class="template-title">ãƒ’ãƒƒãƒ—ãƒ›ãƒƒãƒ—</div>
                            <div class="template-style">ãƒ©ãƒƒãƒ—</div>
                        </div>
                        <div class="template-card" onclick="loadTemplate('idol')" data-template="idol">
                            <div class="template-emoji">ğŸŒ¸</div>
                            <div class="template-title">ã‚¢ã‚¤ãƒ‰ãƒ«</div>
                            <div class="template-style">AKBé¢¨</div>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h2 class="section-title">âš™ï¸ ã‚¹ã‚¿ã‚¤ãƒ«ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º</h2>
                    <div class="form-group">
                        <label for="genre">ã‚¸ãƒ£ãƒ³ãƒ«</label>
                        <select id="genre">
                            <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                            <option value="J-Pop">J-Pop</option>
                            <option value="Enka">æ¼”æ­Œ</option>
                            <option value="Hyper J-Pop">ãƒã‚¤ãƒ‘ãƒ¼J-Pop</option>
                            <option value="Symphonic Metal">ã‚·ãƒ³ãƒ•ã‚©ãƒ‹ãƒƒã‚¯ãƒ¡ã‚¿ãƒ«</option>
                            <option value="Modern Japanese Funk">ãƒ¢ãƒ€ãƒ³å’Œé¢¨ãƒ•ã‚¡ãƒ³ã‚¯</option>
                            <option value="Emotional Guitar Rock">ã‚¨ãƒ¢ãƒ¼ã‚·ãƒ§ãƒŠãƒ«ã‚®ã‚¿ãƒ¼ãƒ­ãƒƒã‚¯</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="vocal-type">ãƒœãƒ¼ã‚«ãƒ«ã‚¿ã‚¤ãƒ—</label>
                        <select id="vocal-type">
                            <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                            <option value="Powerful Female Vocal">åŠ›å¼·ã„å¥³æ€§ãƒœãƒ¼ã‚«ãƒ«</option>
                            <option value="Soft Female Vocal">æŸ”ã‚‰ã‹ã„å¥³æ€§ãƒœãƒ¼ã‚«ãƒ«</option>
                            <option value="Male Vocal">ç”·æ€§ãƒœãƒ¼ã‚«ãƒ«</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="bpm">BPM</label>
                        <input type="number" id="bpm" min="60" max="200" step="5" placeholder="ä¾‹: 120">
                    </div>

                    <div class="form-group">
                        <label>è¿½åŠ ã‚¿ã‚°</label>
                        <select id="additional-tags" multiple size="6">
                            <option value="Dramatic Strings">åŠ‡çš„ãªå¼¦æ¥½å™¨</option>
                            <option value="Acoustic Guitar">ã‚¢ã‚³ãƒ¼ã‚¹ãƒ†ã‚£ãƒƒã‚¯ã‚®ã‚¿ãƒ¼</option>
                            <option value="Heavy Bass">é‡åšãªãƒ™ãƒ¼ã‚¹</option>
                            <option value="Electronic">ã‚¨ãƒ¬ã‚¯ãƒˆãƒ­ãƒ‹ãƒƒã‚¯</option>
                            <option value="High Energy">ãƒã‚¤ã‚¨ãƒŠã‚¸ãƒ¼</option>
                            <option value="Emotional">ã‚¨ãƒ¢ãƒ¼ã‚·ãƒ§ãƒŠãƒ«</option>
                        </select>
                        <div class="tags-display" id="selected-tags"></div>
                    </div>
                </div>

                <div class="section">
                    <h2 class="section-title">ğŸ·ï¸ ã‚¿ã‚°æŒ¿å…¥</h2>
                    <div class="structure-tags">
                        <div class="control-title">æ§‹æˆã‚¿ã‚°</div>
                        <div class="control-tags">
                            <span class="control-tag" onclick="insertTag('[Intro]')">ã‚¤ãƒ³ãƒˆãƒ­</span>
                            <span class="control-tag" onclick="insertTag('[Verse 1]')">ãƒãƒ¼ã‚¹1</span>
                            <span class="control-tag" onclick="insertTag('[Chorus]')">ã‚³ãƒ¼ãƒ©ã‚¹</span>
                            <span class="control-tag" onclick="insertTag('[Bridge]')">ãƒ–ãƒªãƒƒã‚¸</span>
                            <span class="control-tag" onclick="insertTag('[Outro]')">ã‚¢ã‚¦ãƒˆãƒ­</span>
                        </div>
                    </div>

                    <div class="vocal-controls">
                        <div class="control-title">æ­Œå”±ã‚¿ã‚°</div>
                        <div class="control-tags">
                            <span class="control-tag" onclick="insertTag('[Staccato]')">ã‚¹ã‚¿ãƒƒã‚«ãƒ¼ãƒˆ</span>
                            <span class="control-tag" onclick="insertTag('[Belting]')">ãƒ™ãƒ«ãƒ†ã‚£ãƒ³ã‚°</span>
                            <span class="control-tag" onclick="insertTag('[Whisper]')">ã‚¦ã‚£ã‚¹ãƒ‘ãƒ¼</span>
                            <span class="control-tag" onclick="insertTag('[Powerful]')">ãƒ‘ãƒ¯ãƒ•ãƒ«</span>
                        </div>
                    </div>
                </div>

                <div class="example-section">
                    <div class="example-title">ğŸ’¡ ä½œæˆã®ã‚³ãƒ„</div>
                    <div class="example-text">
                        â€¢ å¥èª­ç‚¹ã§åŒºåˆ‡ã‚‹: ã€Œã‚ã—ãŸã€‚ ä¸–ç•ŒãŒã€‚ã€<br>
                        â€¢ æ§‹æˆã‚¿ã‚°ã¯å¿…é ˆ<br>
                        â€¢ æ­Œå”±ã‚¿ã‚°ã§è¡¨ç¾åŠ›UP
                    </div>
                </div>
            </div>

            <div class="right-panel">
                <div class="lyrics-section">
                    <div class="lyrics-header">
                        <div class="lyrics-title">ğŸ“ æ­Œè©ç·¨é›†</div>
                        <div style="display: flex; gap: 6px; align-items: center;">
                            <button class="btn btn-primary btn-small" onclick="copyToClipboard()">ğŸ“‹ ã‚³ãƒ”ãƒ¼</button>
                            <div class="char-count" id="char-count">0 æ–‡å­—</div>
                        </div>
                    </div>
                    <textarea id="lyrics" placeholder="ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’é¸æŠã™ã‚‹ã‹ã€ã“ã“ã«æ­Œè©ã‚’å…¥åŠ›..."></textarea>
                </div>

                <div class="output-section-bottom">
                    <h3 style="font-size: 0.85em; color: #667eea; margin-bottom: 6px;">ğŸµ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ</h3>
                    <div class="output-box" id="output">ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™...</div>
                    <div class="output-actions">
                        <button class="btn btn-secondary btn-small" onclick="clearAll()">ğŸ—‘ï¸ ã‚¯ãƒªã‚¢</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const customTags = [];
        const templates = {
            rock: {
                style: "Emotional Guitar Rock, J-Pop, Powerful Female Vocal, 95 BPM",
                lyrics: `[Intro]\n[Acoustic Guitar]\n\n[Verse 1]\n[Soft]\næ¯ã‚ŒãŸèŠ±ã€‚ æºã‚Œã‚‹å½±ã€‚\n\n[Chorus]\n[Powerful]\næ˜æ—¥ä¸–ç•ŒãŒçµ‚ã‚ã‚‹ã¨ã—ã¦ã‚‚\nå›ã®æ‰‹ã‚’é›¢ã•ãªã„\n[End]`
            },
            enka: {
                style: "Enka, Dramatic Strings, Vibrato, 70 BPM",
                lyrics: `[Intro]\n[Dramatic Strings]\n\n[Verse 1]\nèº«ã«çºã†ã®ã¯ã€‚ é’ã„åˆ¶æœã€‚\n\n[Chorus]\n[Powerful Enka]\nä»Šã€‚ è­¦æˆ’ä¸­ã€‚\n[End]`
            },
            symphonic: {
                style: "Symphonic Metal, High Energy, Powerful Vocal, 190 BPM",
                lyrics: `[Intro]\n[Dramatic Strings]\n\n[Verse 1]\n[Staccato]\nå…‰ã€‚ é—‡ã€‚ äº¤å·®ã™ã‚‹ã€‚\n\n[Chorus]\n[Maximum Energy]\næœ€å¼·ï¼ ç„¡æ•µï¼\n[End]`
            },
            hyperpop: {
                style: "Hyper-pop, Catchy, High Energy, 160 BPM",
                lyrics: `[Chorus]\n[Catchy Hook]\nã¡ã‚ƒã‚“ã¨ã€‚ ç¢ºèªã€‚ ã—ã‚ˆã†ã‹ã€‚\n[End]`
            },
            funk: {
                style: "Modern Japanese Funk, Bouncy Bass, Groovy, 165 BPM",
                lyrics: `[Intro]\n[Heavy Bass]\n\n[Verse 1]\n[Staccato]\nã€Œä¸€æ™‚ã€ã®ã€‚ è¿·ã„ã€‚\n\n[Chorus]\n[Groovy]\nè®ƒãˆã‚ˆï¼\n[End]`
            },
            vocaloid: {
                style: "Vocaloid Pop, Fast Electronic, Cute Vocal, 180 BPM",
                lyrics: `[Intro]\n[Electronic]\n\n[Verse 1]\nãƒ‡ã‚¸ã‚¿ãƒ«ã€‚ ä¸–ç•Œã§ã€‚\n\n[Chorus]\né›»è„³ä¸–ç•Œã§ã€‚ è¸Šã‚ã†ã‚ˆã€‚\n[End]`
            },
            anime: {
                style: "Anime Opening, J-Rock, Heroic, 175 BPM",
                lyrics: `[Intro]\n[Dramatic Strings]\n\n[Verse 1]\nå¤œæ˜ã‘ã‚’ã€‚ å¾…ãŸãšã«ã€‚\n\n[Chorus]\né£›ã³ç«‹ã¦ï¼ å¤¢ã®å½¼æ–¹ã¸ã€‚\n[End]`
            },
            ballad: {
                style: "Emotional Ballad, Piano, Soft Vocal, 75 BPM",
                lyrics: `[Intro]\n[Piano]\n\n[Verse 1]\n[Whisper]\né™ã‹ã«ã€‚ é™ã‚‹é›¨ã€‚\n\n[Chorus]\n[Belting]\næ„›ã—ã¦ãŸã€‚ æœ¬å½“ã«ã€‚\n[End]`
            },
            citypop: {
                style: "City Pop, Funk, Synth, Groovy, 110 BPM",
                lyrics: `[Intro]\n[Synth Pad]\n\n[Verse 1]\nå¤œã®è¡—ã€‚ ãƒã‚ªãƒ³ã€‚\n\n[Chorus]\nã‚·ãƒ†ã‚£ãƒ©ã‚¤ãƒ„ã€‚\n[End]`
            },
            edm: {
                style: "EDM, Heavy Bass Drop, High Energy, 128 BPM",
                lyrics: `[Intro]\n[Build-up]\n\n[Verse 1]\nãƒ•ãƒ­ã‚¢ãŒã€‚ æºã‚Œã‚‹ã€‚\n\n[Chorus]\n[Drop]\nãƒ™ãƒ¼ã‚¹ãŒã€‚ çˆ†ç™ºã€‚\n[End]`
            },
            hiphop: {
                style: "Japanese Hip Hop, Rap, Urban, 90 BPM",
                lyrics: `[Intro]\n[Beat]\n\n[Verse 1]\n[Rap]\nãƒã‚¤ã‚¯ã‚’æ¡ã£ã¦ã€‚\n\n[Chorus]\nå¤¢è¿½ã„ã‹ã‘ã¦ã€‚\n[End]`
            },
            idol: {
                style: "Idol Pop, Cute, Cheerful, Dance Beat, 140 BPM",
                lyrics: `[Intro]\n[Upbeat]\n\n[Verse 1]\n[Cute]\nãŠã¯ã‚ˆã†ã€‚ ä¸–ç•Œã€‚\n\n[Chorus]\nå¤¢ã«å‘ã‹ã£ã¦ã€‚\n[End]`
            }
        };

        document.getElementById('genre').addEventListener('change', generatePrompt);
        document.getElementById('vocal-type').addEventListener('change', generatePrompt);
        document.getElementById('bpm').addEventListener('input', generatePrompt);
        document.getElementById('lyrics').addEventListener('input', function() {
            updateCharCount();
            generatePrompt();
        });
        document.getElementById('additional-tags').addEventListener('change', function() {
            updateSelectedTags();
            generatePrompt();
        });

        function updateCharCount() {
            const lyrics = document.getElementById('lyrics').value;
            document.getElementById('char-count').textContent = `${lyrics.length} æ–‡å­—`;
        }

        function updateSelectedTags() {
            const select = document.getElementById('additional-tags');
            customTags.length = 0;
            Array.from(select.selectedOptions).forEach(option => {
                customTags.push(option.value);
            });
            
            const container = document.getElementById('selected-tags');
            container.innerHTML = customTags.map((tag, index) => `
                <span class="tag">
                    ${tag}
                    <span class="tag-remove" onclick="removeTag(${index})">Ã—</span>
                </span>
            `).join('');
        }

        function removeTag(index) {
            const tagToRemove = customTags[index];
            customTags.splice(index, 1);
            
            const select = document.getElementById('additional-tags');
            Array.from(select.options).forEach(option => {
                if (option.value === tagToRemove) {
                    option.selected = false;
                }
            });
            
            updateSelectedTags();
            generatePrompt();
        }

        function insertTag(tag) {
            const lyricsField = document.getElementById('lyrics');
            const start = lyricsField.selectionStart;
            const text = lyricsField.value;
            
            lyricsField.value = text.substring(0, start) + tag + '\n' + text.substring(start);
            lyricsField.focus();
            lyricsField.selectionStart = lyricsField.selectionEnd = start + tag.length + 1;
            
            updateCharCount();
            generatePrompt();
        }

        function loadTemplate(templateName) {
            const template = templates[templateName];
            if (template) {
                document.querySelectorAll('.template-card').forEach(card => {
                    card.classList.remove('active');
                });
                document.querySelector(`.template-card[data-template="${templateName}"]`).classList.add('active');
                
                document.getElementById('lyrics').value = template.lyrics;
                
                const styleTags = template.style.split(', ');
                customTags.length = 0;
                
                const bpmMatch = template.style.match(/(\d+)\s*BPM/);
                if (bpmMatch) {
                    document.getElementById('bpm').value = bpmMatch[1];
                }
                
                const select = document.getElementById('additional-tags');
                Array.from(select.options).forEach(option => option.selected = false);
                
                updateSelectedTags();
                updateCharCount();
                generatePrompt();
            }
        }

        function generatePrompt() {
            const genre = document.getElementById('genre').value;
            const vocalType = document.getElementById('vocal-type').value;
            const bpm = document.getElementById('bpm').value;
            const lyrics = document.getElementById('lyrics').value;
            
            const styleParts = [];
            if (genre) styleParts.push(genre);
            if (vocalType) styleParts.push(vocalType);
            customTags.forEach(tag => styleParts.push(tag));
            if (bpm) styleParts.push(`${bpm} BPM`);
            
            const style = styleParts.join(', ');
            const output = `Style: ${style || '(ã‚¹ã‚¿ã‚¤ãƒ«ã‚’æŒ‡å®šã—ã¦ãã ã•ã„)'}\n\nLyrics:\n${lyrics || '(æ­Œè©ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„)'}`;
            document.getElementById('output').textContent = output;
        }

        function copyToClipboard() {
            const output = document.getElementById('output').textContent;
            navigator.clipboard.writeText(output).then(() => {
                alert('ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼');
            });
        }

        function clearAll() {
            document.getElementById('genre').value = '';
            document.getElementById('vocal-type').value = '';
            document.getElementById('bpm').value = '';
            document.getElementById('lyrics').value = '';
            customTags.length = 0;
            const select = document.getElementById('additional-tags');
            Array.from(select.options).forEach(option => option.selected = false);
            document.querySelectorAll('.template-card').forEach(card => card.classList.remove('active'));
            updateSelectedTags();
            updateCharCount();
            document.getElementById('output').textContent = 'ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™...';
        }

        // åˆæœŸåŒ–
        generatePrompt();
        updateCharCount();

        // Service Worker ç™»éŒ²
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then(reg => console.log('Service Worker registered'))
                    .catch(err => console.log('Service Worker registration failed', err));
            });
        }
    </script>
</body>
</html>